{"version":3,"sources":["scripts/embed-application.js"],"sourcesContent":["(function () {\n  const referer = document.getElementById(\"data-embedded\").dataset.referer;\n  function postUp(msg) {\n    if (parent) {\n      parent.postMessage(msg, referer);\n    }\n  }\n  function clickPostLink(e) {\n    let postId = e.target.getAttribute(\"data-link-to-post\");\n    if (postId) {\n      let postElement = document.getElementById(\"post-\" + postId);\n      if (postElement) {\n        let rect = postElement.getBoundingClientRect();\n        if (rect && rect.top) {\n          postUp({\n            type: \"discourse-scroll\",\n            top: rect.top\n          });\n          e.preventDefault();\n          return false;\n        }\n      }\n    }\n  }\n  window.onload = function () {\n    // get state info from data attribute\n    let embedState = document.querySelector(\"[data-embed-state]\");\n    let state = \"unknown\";\n    let embedId = null;\n    if (embedState) {\n      state = embedState.getAttribute(\"data-embed-state\");\n      embedId = embedState.getAttribute(\"data-embed-id\");\n    }\n\n    // Send a post message with our loaded height and state\n    postUp({\n      type: \"discourse-resize\",\n      height: document[\"body\"].offsetHeight,\n      state,\n      embedId\n    });\n    let postLinks = document.querySelectorAll(\"a[data-link-to-post]\"),\n      i;\n    for (i = 0; i < postLinks.length; i++) {\n      postLinks[i].onclick = clickPostLink;\n    }\n\n    // Make sure all links in the iframe point to _blank\n    let cookedLinks = document.querySelectorAll(\".cooked a\");\n    for (i = 0; i < cookedLinks.length; i++) {\n      cookedLinks[i].target = \"_blank\";\n    }\n\n    // Adjust all names\n    let names = document.querySelectorAll(\".username a\");\n    for (i = 0; i < names.length; i++) {\n      let username = names[i].innerHTML;\n      if (username) {\n        /* global BreakString */\n        names[i].innerHTML = new BreakString(username).break();\n      }\n    }\n\n    // Use a # for hashtags since we don't have the JS and icons needed here to render the proper icon.\n    let hashtags = document.querySelectorAll(\".cooked a.hashtag-cooked\");\n    for (i = 0; i < hashtags.length; i++) {\n      hashtags[i].querySelector(\".hashtag-icon-placeholder .d-icon\").remove();\n      hashtags[i].querySelector(\".hashtag-icon-placeholder\").innerText = \"#\";\n    }\n  };\n})();\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"embed-application.js"}