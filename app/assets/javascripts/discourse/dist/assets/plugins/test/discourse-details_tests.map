{"version":3,"sources":["discourse/plugins/discourse-details/acceptance/details-button-test.js","discourse/plugins/discourse-details/lib/details-cooked-test.js"],"sourcesContent":["define(\"discourse/plugins/discourse-details/acceptance/details-button-test\", [\"@ember/test-helpers\", \"qunit\", \"discourse/tests/helpers/qunit-helpers\", \"discourse/tests/helpers/select-kit-helper\", \"discourse-i18n\"], function (_testHelpers, _qunit, _qunitHelpers, _selectKitHelper, _discourseI18n) {\n  \"use strict\";\n\n  (0, _qunitHelpers.acceptance)(\"Details Button\", function (needs) {\n    needs.user();\n    (0, _qunit.test)(\"details button\", async function (assert) {\n      const popupMenu = (0, _selectKitHelper.default)(\".toolbar-popup-menu-options\");\n      await (0, _testHelpers.visit)(\"/\");\n      await (0, _testHelpers.click)(\"#create-topic\");\n      const categoryChooser = (0, _selectKitHelper.default)(\".category-chooser\");\n      await categoryChooser.expand();\n      await categoryChooser.selectRowByValue(2);\n      await popupMenu.expand();\n      await popupMenu.selectRowByName(_discourseI18n.default.t(\"details.title\"));\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_discourseI18n.default.t(\"composer.details_title\")}\"]\\n${_discourseI18n.default.t(\"composer.details_text\")}\\n[/details]\\n`, \"it should contain the right output\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"This is my title\");\n      const textarea = (0, _qunitHelpers.query)(\".d-editor-input\");\n      textarea.selectionStart = 0;\n      textarea.selectionEnd = textarea.value.length;\n      await popupMenu.expand();\n      await popupMenu.selectRowByName(_discourseI18n.default.t(\"details.title\"));\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_discourseI18n.default.t(\"composer.details_title\")}\"]\\nThis is my title\\n[/details]\\n`, \"it should contain the right selected output\");\n      assert.strictEqual(textarea.selectionStart, 21, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 37, \"it should end highlighting at the right position\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"Before some text in between After\");\n      textarea.selectionStart = 7;\n      textarea.selectionEnd = 28;\n      await popupMenu.expand();\n      await popupMenu.selectRowByName(_discourseI18n.default.t(\"details.title\"));\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `Before \\n[details=\"${_discourseI18n.default.t(\"composer.details_title\")}\"]\\nsome text in between\\n[/details]\\n After`, \"it should contain the right output\");\n      assert.strictEqual(textarea.selectionStart, 28, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 48, \"it should end highlighting at the right position\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"Before \\nsome text in between\\n After\");\n      textarea.selectionStart = 8;\n      textarea.selectionEnd = 29;\n      await popupMenu.expand();\n      await popupMenu.selectRowByName(_discourseI18n.default.t(\"details.title\"));\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `Before \\n\\n[details=\"${_discourseI18n.default.t(\"composer.details_title\")}\"]\\nsome text in between\\n[/details]\\n\\n After`, \"it should contain the right output\");\n      assert.strictEqual(textarea.selectionStart, 29, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 49, \"it should end highlighting at the right position\");\n    });\n    (0, _qunit.test)(\"details button surrounds all selected text in a single details block\", async function (assert) {\n      const multilineInput = \"first line\\n\\nsecond line\\n\\nthird line\";\n      const popupMenu = (0, _selectKitHelper.default)(\".toolbar-popup-menu-options\");\n      await (0, _testHelpers.visit)(\"/\");\n      await (0, _testHelpers.click)(\"#create-topic\");\n      const categoryChooser = (0, _selectKitHelper.default)(\".category-chooser\");\n      await categoryChooser.expand();\n      await categoryChooser.selectRowByValue(2);\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", multilineInput);\n      const textarea = (0, _qunitHelpers.query)(\".d-editor-input\");\n      textarea.selectionStart = 0;\n      textarea.selectionEnd = textarea.value.length;\n      await popupMenu.expand();\n      await popupMenu.selectRowByName(_discourseI18n.default.t(\"details.title\"));\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_discourseI18n.default.t(\"composer.details_title\")}\"]\\n${multilineInput}\\n[/details]\\n`, \"it should contain the right output\");\n    });\n  });\n});","define(\"discourse/plugins/discourse-details/lib/details-cooked-test\", [\"qunit\", \"discourse/lib/text\"], function (_qunit, _text) {\n  \"use strict\";\n\n  const opts = {\n    siteSettings: {\n      enable_emoji: true,\n      emoji_set: \"twitter\",\n      highlighted_languages: \"json|ruby|javascript\",\n      default_code_lang: \"auto\"\n    },\n    censoredWords: \"shucks|whiz|whizzer\",\n    getURL: url => url\n  };\n  (0, _qunit.module)(\"lib:details-cooked-test\", function () {\n    (0, _qunit.test)(\"details\", async function (assert) {\n      const testCooked = async (input, expected, text) => {\n        const cooked = (await (0, _text.cook)(input, opts)).toString();\n        assert.strictEqual(cooked, expected, text);\n      };\n      await testCooked(`<details><summary>Info</summary>coucou</details>`, `<details><summary>Info</summary>coucou</details>`, \"manual HTML for details\");\n      await testCooked(\"[details=testing]\\ntest\\n[/details]\", `<details>\n<summary>\ntesting</summary>\n<p>test</p>\n</details>`);\n    });\n  });\n});"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"discourse-details_tests.js"}