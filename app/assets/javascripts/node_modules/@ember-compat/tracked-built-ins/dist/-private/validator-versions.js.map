{"version":3,"file":"validator-versions.js","sources":["../../src/-private/validator-versions.ts"],"sourcesContent":["import * as validator from '@glimmer/validator';\n\ntype Tag = object;\n\n// v0.84\ninterface V84 {\n  consumeTag: (tag: Tag) => void;\n  tagFor: (object: object, property: PropertyKey) => Tag;\n  dirtyTagFor: (object: object, property: PropertyKey) => void;\n}\n\n// v0.44\ninterface V44 {\n  consume: (tag: Tag) => void;\n  tagFor: (object: object, property: PropertyKey) => Tag;\n  dirty: (tag: Tag) => void;\n}\n\ntype ValidatorVersions = V84 | V44;\n\nfunction isV84(validator: ValidatorVersions): validator is V84 {\n  return (\n    'consumeTag' in validator &&\n    typeof validator.consumeTag === 'function' &&\n    'tagFor' in validator &&\n    typeof validator.tagFor === 'function' &&\n    'dirtyTagFor' in validator &&\n    typeof validator.dirtyTagFor === 'function'\n  );\n}\n\ninterface Validator {\n  dirtyProperty: (object: object, property: PropertyKey) => void;\n  consumeProperty: (object: object, property: PropertyKey) => void;\n}\n\nfunction normalize(module: ValidatorVersions): Validator {\n  if (isV84(module)) {\n    return {\n      dirtyProperty: (object: object, property: PropertyKey) => {\n        module.dirtyTagFor(object, property);\n      },\n      consumeProperty: (object: object, property: PropertyKey) => {\n        module.consumeTag(module.tagFor(object, property));\n      },\n    };\n  } else {\n    throw new Error(\n      'The version of @glimmer/validator included with this build is incompatible with @ember-compat/tracked-built-ins. '\n    );\n  }\n}\n\nconst { dirtyProperty, consumeProperty } = normalize(\n  validator as ValidatorVersions\n);\n\nexport { dirtyProperty, consumeProperty };\n"],"names":["isV84","validator","consumeTag","tagFor","dirtyTagFor","normalize","module","dirtyProperty","object","property","consumeProperty","Error"],"mappings":";;AAoBA,SAASA,KAAK,CAACC,SAA4B,EAAoB;AAC7D,EAAA,OACE,YAAY,IAAIA,SAAS,IACzB,OAAOA,SAAS,CAACC,UAAU,KAAK,UAAU,IAC1C,QAAQ,IAAID,SAAS,IACrB,OAAOA,SAAS,CAACE,MAAM,KAAK,UAAU,IACtC,aAAa,IAAIF,SAAS,IAC1B,OAAOA,SAAS,CAACG,WAAW,KAAK,UAAU,CAAA;AAE/C,CAAA;AAOA,SAASC,SAAS,CAACC,MAAyB,EAAa;AACvD,EAAA,IAAIN,KAAK,CAACM,MAAM,CAAC,EAAE;IACjB,OAAO;AACLC,MAAAA,aAAa,EAAE,CAACC,MAAc,EAAEC,QAAqB,KAAK;AACxDH,QAAAA,MAAM,CAACF,WAAW,CAACI,MAAM,EAAEC,QAAQ,CAAC,CAAA;OACrC;AACDC,MAAAA,eAAe,EAAE,CAACF,MAAc,EAAEC,QAAqB,KAAK;QAC1DH,MAAM,CAACJ,UAAU,CAACI,MAAM,CAACH,MAAM,CAACK,MAAM,EAAEC,QAAQ,CAAC,CAAC,CAAA;AACpD,OAAA;KACD,CAAA;AACH,GAAC,MAAM;AACL,IAAA,MAAM,IAAIE,KAAK,CACb,mHAAmH,CACpH,CAAA;AACH,GAAA;AACF,CAAA;AAEM,MAAA;EAAEJ,aAAa;AAAEG,EAAAA,eAAAA;AAAgB,CAAC,GAAGL,SAAS,CAClDJ,SAAS;;;;"}